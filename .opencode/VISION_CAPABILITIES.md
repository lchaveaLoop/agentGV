# AgentGV 视觉理解能力指南

**版本**: 1.0.0  
**日期**: 2026-02-24  
**模型**: qwen3.5-plus（支持视觉理解）

---

## 📸 支持的视觉任务

### 1. 图像理解与问答
**关键词**: `图片`, `图像`, `截图`, `照片`, `这是什么`

**示例**:
```
分析这张图片的内容
这张图里有什么？
帮我描述一下这个截图
```

**应用场景**:
- 图像内容描述
- 物体识别与定位
- 场景理解
- 图像分类

---

### 2. OCR 文字识别
**关键词**: `文字识别`, `提取文字`, `截图文字`, `图片文字`, `票据`, `证件`

**示例**:
```
提取这张图片中的所有文字
识别这个截图中的文字内容
帮我读取这张发票的信息
```

**支持格式**:
- 文档扫描件
- 截图文字
- 票据/发票
- 证件信息
- 表格数据

---

### 3. 视觉编程 (Image to Code)
**关键词**: `根据图片生成代码`, `截图转代码`, `设计图转网页`, `UI 转代码`

**示例**:
```
根据这个设计图生成 HTML/CSS 代码
把这个网页截图转换成前端代码
根据这个 UI 草图创建网页
```

**支持输出**:
- HTML/CSS/JS 代码
- React/Vue 组件
- 响应式布局

---

### 4. 文档解析
**关键词**: `解析 PDF`, `扫描件`, `文档转 Markdown`

**示例**:
```
把这个 PDF 扫描件转换成 Markdown 格式
解析这个文档并提取结构化内容
```

**支持格式**:
- 图片 PDF
- 扫描件
- 技术文档
- 学术论文

---

### 5. 多图像分析
**关键词**: `对比`, `多图`, `这几张图片`

**示例**:
```
对比这两张图片的差异
分析这几张图片的内容
```

**应用场景**:
- 商品对比
- 版本差异
- 多页文档处理
- 前后对比分析

---

### 6. 图表分析
**关键词**: `chart`, `graph`, `diagram`, `流程图`, `架构图`, `数据图表`

**示例**:
```
分析这个架构图
解释这个流程图的含义
提取这个图表中的数据
```

---

## 🚀 使用方法

### 方式 1: 直接对话（推荐）
在 OpenCode Desktop 中直接上传的图片并提问：

```
[上传图片] 
请分析这张图片的内容
```

### 方式 2: 指定视觉任务类型
```
帮我做 OCR 识别这张图片
将这个设计图转换成代码
分析这个架构图
```

### 方式 3: 使用 CLI（需配置图片 URL）
```bash
# 通过 API 调用（需要自行编写脚本）
node .opencode/vision-analyzer.js "图片 URL" "问题描述"
```

---

## 📋 任务类型与模型映射

| 任务类型 | 关键词 | 默认模型 | 温度 |
|----------|--------|----------|------|
| **vision** | 图片，图像，视觉，截图 | qwen3.5-plus | 0.2 |
| **ocr** | 文字识别，提取文字，票据 | qwen3.5-plus | 0.1 |
| **visual_coding** | 截图转代码，设计图转网页 | qwen3.5-plus | 0.3 |

---

## ⚙️ 技术配置

### API 调用格式
```json
{
  "model": "qwen3.5-plus",
  "messages": [{
    "role": "user",
    "content": [
      {"type": "image_url", "image_url": {"url": "图片 URL"}},
      {"type": "text", "text": "问题描述"}
    ]
  }]
}
```

### 支持的地域
- ✅ 北京（推荐）
- ✅ 新加坡
- ✅ 弗吉尼亚

### 图片限制
- **格式**: JPEG, PNG, WebP, GIF
- **大小**: 最大 20MB
- **分辨率**: 建议 4096x4096 以内
- **数量**: 单次请求最多 16 张图片

---

## 💡 最佳实践

### 1. 图像理解
✅ **推荐**:
```
请详细描述这张图片的内容，包括：
- 主要物体
- 场景背景
- 人物动作
- 颜色搭配
```

❌ **避免**:
```
这是什么？（太模糊）
```

### 2. OCR 识别
✅ **推荐**:
```
请提取图片中的所有文字，并按原始格式输出。
如果有表格，请以 Markdown 表格形式呈现。
```

❌ **避免**:
```
读取文字（不够具体）
```

### 3. 视觉编程
✅ **推荐**:
```
根据这个设计图生成响应式网页代码：
- 使用 HTML5 + CSS3
- 主色调为黑色
- 适配移动端和桌面端
- 使用 Flexbox 布局
```

❌ **避免**:
```
生成代码（缺少具体要求）
```

### 4. 多图像分析
✅ **推荐**:
```
请对比这两张图片，分析：
1. 相同点
2. 不同点
3. 改进建议
```

---

## 🔧 高级功能

### 思考模式
qwen3.5-plus 支持开启/关闭思考模式：

- **开启** (`enable_thinking: true`): 适合复杂视觉推理任务
- **关闭** (`enable_thinking: false`): 适合简单图像描述

### 结构化输出
支持 JSON 格式输出，适用于：
- OCR 信息提取
- 物体检测结果
- 图表数据提取

**示例**:
```
提取图中的发票信息，以 JSON 格式输出：
{
  "发票代码": "",
  "发票号码": "",
  "金额": "",
  "日期": ""
}
```

---

## 📊 能力对比

| 能力 | qwen3.5-plus | qwen3-vl-plus | qwen2.5-vl |
|------|--------------|---------------|------------|
| 图像理解 | ✅ | ✅ | ✅ |
| OCR | ✅ | ✅ | ✅ |
| 视觉编程 | ✅ | ✅ | ⚠️ |
| 文档解析 | ✅ | ✅ | ❌ |
| 多图像分析 | ✅ | ✅ | ⚠️ |
| 视频理解 | ✅ | ✅ | ⚠️ |
| 3D 定位 | ✅ | ✅ | ❌ |
| 思考模式 | ✅ | ✅ | ❌ |

**推荐**: 优先使用 `qwen3.5-plus`，综合性能最佳

---

## 🎯 使用示例

### 示例 1: 分析架构图
```
用户：[上传架构图]
     请分析这个系统架构，说明各组件的作用和数据流向。

Router: 🔄 Routing to: @agentgv-planning
        📊 Model: qwen3.5-plus (Vision enabled)
        🌡️ Temperature: 0.2
```

### 示例 2: 截图转代码
```
用户：[上传网页截图]
     根据这个设计生成 HTML/CSS 代码，主色调为蓝色。

Router: 🔄 Routing to: @agentgv-operations<visual_coding>
        📊 Model: qwen3.5-plus (Vision enabled)
        🌡️ Temperature: 0.3
```

### 示例 3: OCR 识别
```
用户：[上传发票图片]
     提取这张发票的关键信息，以 JSON 格式输出。

Router: 🔄 Routing to: @agentgv-operations<ocr>
        📊 Model: qwen3.5-plus (Vision enabled)
        🌡️ Temperature: 0.1
```

### 示例 4: 多图像对比
```
用户：[上传两张设计图]
     对比这两个版本的差异，列出所有改动。

Router: 🔄 Routing to: @agentgv-quality
        📊 Model: qwen3.5-plus (Vision enabled)
        🌡️ Temperature: 0.2
```

---

## ⚠️ 注意事项

### 图片上传
1. **本地文件**: 需要通过文件上传功能或转换为 Base64
2. **网络 URL**: 确保图片可公开访问
3. **隐私保护**: 避免上传敏感信息

### 性能优化
1. **图片大小**: 压缩过大的图片可提升响应速度
2. **单图 vs 多图**: 单图分析速度更快
3. **复杂度**: 复杂分析任务建议开启思考模式

### 成本控制
1. **简单任务**: 使用标准模式（关闭思考）
2. **批量处理**: 合并多张图片到单次请求
3. **缓存**: 重复图片可缓存结果

---

## 🔗 相关文档

- [模型配置](./models.json) - 视觉模型配置
- [任务路由](./MODEL_ROUTING.md) - 视觉任务路由规则
- [阿里云文档](https://help.aliyun.com/zh/model-studio/vision) - 视觉 API 详细说明

---

**状态**: ✅ 已集成 | **模型**: qwen3.5-plus | **支持地域**: 北京/新加坡/弗吉尼亚
